#!/usr/bin/env node

var argv   = require('optimist').argv;
var swap   = require('../lib/core');
var common = require('../lib/common');

if (argv.init) {
    common.initialize(typeof argv.init == 'string' ? argv.init : process.cwd());
} else {
    swap.load(null, function(err) {
        if (!err) {
        argv._.forEach(function(arg) {
          console.log("[+] PROCESSING :", arg);
          swap.processFile(arg, function(err, src) {
            if (!err) {
              console.log(src);
            } else {
              var errMsg = common.errorToString(err);
              console.log(errMsg);
            }
          });
        });
      } else {
        var errMsg = common.errorToString(err);
        console.log(errMsg);
      }
    });
}

